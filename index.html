<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="assets/style.css" type="text/css" rel="stylesheet"/>
    <title>11 IB Kermes Satis Takip Sistemi 2.0</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XSX2LG3E3B"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XSX2LG3E3B');
    </script>
  </head>


  <body>

    <header>
      <a href="/" class="title">11 IB Kermes Satis Takip Sistemi 2.0</a>
    </header>
    <div style="margin: 0 auto;">
      <p>Items</p>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Küpe20" onclick="buttonDec('Küpe20')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Küpe20" onclick="buttonInc('Küpe20')"/>
  <span id="Küpe20 num" name="20"></span>
  <span>x Küpe (20 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Küpe25" onclick="buttonDec('Küpe25')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Küpe25" onclick="buttonInc('Küpe25')"/>
  <span id="Küpe25 num" name="25"></span>
  <span>x Küpe (25 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Küpe30" onclick="buttonDec('Küpe30')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Küpe30" onclick="buttonInc('Küpe30')"/>
  <span id="Küpe30 num" name="30"></span>
  <span>x Küpe (30 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Küpe35" onclick="buttonDec('Küpe35')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Küpe35" onclick="buttonInc('Küpe35')"/>
  <span id="Küpe35 num" name="35"></span>
  <span>x Küpe (35 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Küpe40" onclick="buttonDec('Küpe40')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Küpe40" onclick="buttonInc('Küpe40')"/>
  <span id="Küpe40 num" name="40"></span>
  <span>x Küpe (40 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Bilezik40" onclick="buttonDec('Bilezik40')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Bilezik40" onclick="buttonInc('Bilezik40')"/>
  <span id="Bilezik40 num" name="40"></span>
  <span>x Bilezik (40 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Bilezik55" onclick="buttonDec('Bilezik55')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Bilezik55" onclick="buttonInc('Bilezik55')"/>
  <span id="Bilezik55 num" name="55"></span>
  <span>x Bilezik (55 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Bilezik60" onclick="buttonDec('Bilezik60')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Bilezik60" onclick="buttonInc('Bilezik60')"/>
  <span id="Bilezik60 num" name="60"></span>
  <span>x Bilezik (60 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Bilezik80" onclick="buttonDec('Bilezik80')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Bilezik80" onclick="buttonInc('Bilezik80')"/>
  <span id="Bilezik80 num" name="80"></span>
  <span>x Bilezik (80 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Bilezik100" onclick="buttonDec('Bilezik100')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Bilezik100" onclick="buttonInc('Bilezik100')"/>
  <span id="Bilezik100 num" name="100"></span>
  <span>x Bilezik (100 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Kitap Ayracı15" onclick="buttonDec('Kitap Ayracı15')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Kitap Ayracı15" onclick="buttonInc('Kitap Ayracı15')"/>
  <span id="Kitap Ayracı15 num" name="15"></span>
  <span>x Kitap Ayracı (15 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="İp Bileklik35" onclick="buttonDec('İp Bileklik35')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="İp Bileklik35" onclick="buttonInc('İp Bileklik35')"/>
  <span id="İp Bileklik35 num" name="35"></span>
  <span>x İp Bileklik (35 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Kolye55" onclick="buttonDec('Kolye55')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Kolye55" onclick="buttonInc('Kolye55')"/>
  <span id="Kolye55 num" name="55"></span>
  <span>x Kolye (55 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Kolye65" onclick="buttonDec('Kolye65')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Kolye65" onclick="buttonInc('Kolye65')"/>
  <span id="Kolye65 num" name="65"></span>
  <span>x Kolye (65 TL)</span>
</div>
<p>Foods</p>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Waffle - Bir Meyveli40" onclick="buttonDec('Waffle - Bir Meyveli40')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Waffle - Bir Meyveli40" onclick="buttonInc('Waffle - Bir Meyveli40')"/>
  <span id="Waffle - Bir Meyveli40 num" name="40"></span>
  <span>x Waffle - Bir Meyveli (40 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Waffle - İki Meyveli45" onclick="buttonDec('Waffle - İki Meyveli45')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Waffle - İki Meyveli45" onclick="buttonInc('Waffle - İki Meyveli45')"/>
  <span id="Waffle - İki Meyveli45 num" name="45"></span>
  <span>x Waffle - İki Meyveli (45 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Waffle - Üç Meyveli50" onclick="buttonDec('Waffle - Üç Meyveli50')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Waffle - Üç Meyveli50" onclick="buttonInc('Waffle - Üç Meyveli50')"/>
  <span id="Waffle - Üç Meyveli50 num" name="50"></span>
  <span>x Waffle - Üç Meyveli (50 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Makarna Salatası15" onclick="buttonDec('Makarna Salatası15')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Makarna Salatası15" onclick="buttonInc('Makarna Salatası15')"/>
  <span id="Makarna Salatası15 num" name="15"></span>
  <span>x Makarna Salatası (15 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Çikolatalı Kurabiye10" onclick="buttonDec('Çikolatalı Kurabiye10')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Çikolatalı Kurabiye10" onclick="buttonInc('Çikolatalı Kurabiye10')"/>
  <span id="Çikolatalı Kurabiye10 num" name="10"></span>
  <span>x Çikolatalı Kurabiye (10 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Browni20" onclick="buttonDec('Browni20')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Browni20" onclick="buttonInc('Browni20')"/>
  <span id="Browni20 num" name="20"></span>
  <span>x Browni (20 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Limonata5" onclick="buttonDec('Limonata5')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Limonata5" onclick="buttonInc('Limonata5')"/>
  <span id="Limonata5 num" name="5"></span>
  <span>x Limonata (5 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Naneli Limonata7" onclick="buttonDec('Naneli Limonata7')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Naneli Limonata7" onclick="buttonInc('Naneli Limonata7')"/>
  <span id="Naneli Limonata7 num" name="7"></span>
  <span>x Naneli Limonata (7 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Kısır20" onclick="buttonDec('Kısır20')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Kısır20" onclick="buttonInc('Kısır20')"/>
  <span id="Kısır20 num" name="20"></span>
  <span>x Kısır (20 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Dereotlu Kurabiye8" onclick="buttonDec('Dereotlu Kurabiye8')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Dereotlu Kurabiye8" onclick="buttonInc('Dereotlu Kurabiye8')"/>
  <span id="Dereotlu Kurabiye8 num" name="8"></span>
  <span>x Dereotlu Kurabiye (8 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Tarçınlı Kurabiye15" onclick="buttonDec('Tarçınlı Kurabiye15')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Tarçınlı Kurabiye15" onclick="buttonInc('Tarçınlı Kurabiye15')"/>
  <span id="Tarçınlı Kurabiye15 num" name="15"></span>
  <span>x Tarçınlı Kurabiye (15 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Meyve Salatası30" onclick="buttonDec('Meyve Salatası30')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Meyve Salatası30" onclick="buttonInc('Meyve Salatası30')"/>
  <span id="Meyve Salatası30 num" name="30"></span>
  <span>x Meyve Salatası (30 TL)</span>
</div>
<p>Games</p>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Tekli Bilet15" onclick="buttonDec('Tekli Bilet15')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Tekli Bilet15" onclick="buttonInc('Tekli Bilet15')"/>
  <span id="Tekli Bilet15 num" name="15"></span>
  <span>x Tekli Bilet (15 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="İkili Bilet20" onclick="buttonDec('İkili Bilet20')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="İkili Bilet20" onclick="buttonInc('İkili Bilet20')"/>
  <span id="İkili Bilet20 num" name="20"></span>
  <span>x İkili Bilet (20 TL)</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="Dörtlü Bilet35" onclick="buttonDec('Dörtlü Bilet35')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="Dörtlü Bilet35" onclick="buttonInc('Dörtlü Bilet35')"/>
  <span id="Dörtlü Bilet35 num" name="35"></span>
  <span>x Dörtlü Bilet (35 TL)</span>
</div>
<p>Discounts</p>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="0.5 TL İndirim-0.5" onclick="discountDec('0.5 TL İndirim-0.5')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="0.5 TL İndirim-0.5" onclick="discountInc('0.5 TL İndirim-0.5')"/>
  <span id="0.5 TL İndirim-0.5 num" name="-0.5"></span>
  <span>x 0.5 TL İndirim</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="1 TL İndirim-1" onclick="discountDec('1 TL İndirim-1')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="1 TL İndirim-1" onclick="discountInc('1 TL İndirim-1')"/>
  <span id="1 TL İndirim-1 num" name="-1"></span>
  <span>x 1 TL İndirim</span>
</div>
<div>
  <input type=button class="item-button" value="-" name="sold-item" id="5 TL İndirim-5" onclick="discountDec('5 TL İndirim-5')"/>
  <input type=button class="item-button" value="+" name="sold-item" id="5 TL İndirim-5" onclick="discountInc('5 TL İndirim-5')"/>
  <span id="5 TL İndirim-5 num" name="-5"></span>
  <span>x 5 TL İndirim</span>
</div>
    </div>

    <div style="text-align: center">
      <label for="cost">Total Cost: </label>
      <input type="text" id="cost" name="cost" class="cost-num" inputmode="numeric"> 
    </div>

    <div style="text-align: center">
      <!-- <input type="submit" value="Send" class="button-2" id="send-button" role="button"/> -->
      <button class="button-2" role="button" id="send-button">Send</button>
    </div>

    <div style="text-align: center">
      <b><span id="error"></span></b>
    </div>

    <footer>
      <div>
        Made by <a href="https://www.mkutay.dev/"><b style="color: #bf616a;">Kutay</b></a>
      </div>

      <nav>
        <a href="https://docs.google.com/spreadsheets/d/1mW9xuWIBDuyZQHiYTfuMi6nvPHpZpJANE4p61JfIk5Q/edit?usp=sharing">
          <text style="padding-left: 0.4em">
            Google Sheet
          </text>
        </a>
      </nav>

    </footer>

    <script>
      let totalCost = 0;
      let buttons = document.querySelectorAll("input[name='sold-item']");
      let items = {};
      buttons.forEach((button) => {
        items[button.id] = 0;
        document.getElementById(button.id + " num").innerHTML = 0;
      });
      document.querySelector("#cost").value = 0;
      function buttonInc(id) {
        document.getElementById(id + " num").innerHTML = ++items[id];
        totalCost += Number(document.getElementById(id + " num").getAttribute("name"));
        document.querySelector("#cost").value = totalCost;
      }
      function buttonDec(id) {
        if (items[id] == 0) return;
        document.getElementById(id + " num").innerHTML = --items[id];
        totalCost -= Number(document.getElementById(id + " num").getAttribute("name"));
        document.querySelector("#cost").value = totalCost;
      }
      function discountInc(id) {
        document.getElementById(id + " num").innerHTML = ++items[id];
        totalCost += Number(document.getElementById(id + " num").getAttribute("name"));
        document.querySelector("#cost").value = totalCost;
      }
      function discountDec(id) {
        if (items[id] == 0) return;
        document.getElementById(id + " num").innerHTML = --items[id];
        totalCost -= Number(document.getElementById(id + " num").getAttribute("name"));
        document.querySelector("#cost").value = totalCost;
      }

      const sendBtn = document.querySelector("#send-button");
      sendBtn.addEventListener('click', sendData);
      function sendData(e) {
        e.preventDefault();
        let bought = {};
        for (let key in items) {
          if (items[key] == 0) continue;
          bought[key] = items[key];
        }
        const cost = document.querySelector("#cost").value;

        if (cost == "") {
          document.getElementById("error").style = "color: #bf616a;";
          document.getElementById("error").innerHTML = "Error: No cost written.";
          return;
        } else if (Object.keys(bought).length == 0) {
          document.getElementById("error").style = "color: #bf616a;";
          document.getElementById("error").innerHTML = "Error: No items selected.";
          return;
        } else if (/^[0-9]*\\.?[0-9]*$/.test(cost) == true) {
          document.getElementById("error").style = "color: #bf616a;";
          document.getElementById("error").innerHTML = "Error: Cost contains non digit characters."
          return;
        } else if (cost < 0) {
          document.getElementById("error").style = "color: #bf616a;";
          document.getElementById("error").innerHTML = "Error: Cost is negative."
        }

        document.querySelector("#cost").value = "";
        totalCost = 0;
        for (let key in items) {
          items[key] = 0;
          document.getElementById(key + " num").innerHTML = 0;
        }

        document.getElementById("error").style = "color: #a3be8c;";
        document.getElementById("error").innerHTML = "Success!";

        fetch("/add", {
          method: "POST",
          headers: {
            Accept: "application/json",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            "bought": bought,
            "cost": cost,
            "timeStamp": Date.now()
          })
        })
          .then(res => res.json())
          .then(data => {
            const {
              result
            } = data;
            if (result != "success") {
              console.log("something bad happened");
            }
          })
          .catch(err => console.log(err));
      }
    </script>
  </body>
</html>